# üìã PROCESSUS COMPLETS - Gestion des Acc√®s Logiciels (2024)

## üéØ Vue d'Ensemble

Cette application de gestion des acc√®s logiciels permet de g√©rer compl√®tement les licences, utilisateurs, √©quipes et co√ªts dans une organisation. Bas√©e sur **Supabase** (PostgreSQL + API REST), elle offre une solution compl√®te pour le suivi et l'optimisation des abonnements logiciels.

## üèóÔ∏è Structure des Donn√©es

### Tables Principales

#### üë• **Utilisateurs** (`utilisateurs`)
```sql
- id (UUID, PK)
- nom (VARCHAR) *
- prenom (VARCHAR) *  
- email (VARCHAR) *
- equipe_id (UUID, FK ‚Üí equipes.id)
- telephone (VARCHAR)
- statut (VARCHAR: Actif/Inactif)
- date_creation (TIMESTAMP)
- archived (BOOLEAN)
```

#### üè¢ **√âquipes** (`equipes`) 
```sql
- id (UUID, PK)
- nom (VARCHAR) *
- description (TEXT)
- budget_mensuel (DECIMAL)
- responsable_id (UUID, FK ‚Üí utilisateurs.id)
- date_creation (TIMESTAMP)
```

#### üíª **Logiciels** (`logiciels`)
```sql
- id (UUID, PK)
- nom (VARCHAR) *
- editeur (VARCHAR)
- version (VARCHAR)
- description (TEXT)
- url_officiel (VARCHAR)
- logiciel_de_base (BOOLEAN) -- Logiciel essentiel
- application_shopify (BOOLEAN) -- Sp√©cifique e-commerce
- equipe_id (UUID, FK ‚Üí equipes.id)
- payer_id (UUID, FK ‚Üí utilisateurs.id) -- Qui paye
- moyen_paiement (VARCHAR: carte/prelevement/virement)
- periodicite (VARCHAR: mensuel/annuel/trimestriel)
- date_souscription (DATE)
- statut (VARCHAR: Actif/Inactif/Test)
- archived (BOOLEAN)
- date_creation (TIMESTAMP)
```

#### üîë **Types de Droits** (`droits`)
```sql
- id (UUID, PK)
- nom (VARCHAR) * -- Administrateur/Utilisateur/Lecture/Acc√®s communs
- description (TEXT)
- niveau_acces (INTEGER) -- Niveau num√©rique (1-5)
```

#### üé´ **Acc√®s Utilisateur-Logiciel** (`acces`)
```sql
- id (UUID, PK)
- utilisateur_id (UUID, FK ‚Üí utilisateurs.id) *
- logiciel_id (UUID, FK ‚Üí logiciels.id) *
- droit_id (UUID, FK ‚Üí droits.id) *
- date_attribution (TIMESTAMP)
- date_expiration (DATE)
- statut (VARCHAR: Actif/Suspendu/Expir√©)
- commentaires (TEXT)
```

#### üí∞ **Co√ªts des Licences** (`couts_licences`)
```sql
- id (UUID, PK)
- logiciel_id (UUID, FK ‚Üí logiciels.id) *
- droit_id (UUID, FK ‚Üí droits.id) *
- cout_mensuel (DECIMAL) * -- Co√ªt par utilisateur/mois
- devise (VARCHAR: EUR/USD/GBP)
- date_debut (DATE)
- date_fin (DATE)
- actif (BOOLEAN)
```

#### üìä **Logs d'Audit** (`logs`)
```sql
- id (UUID, PK)
- utilisateur_id (UUID, FK ‚Üí utilisateurs.id)
- action (VARCHAR) -- CREATE/UPDATE/DELETE/LOGIN
- table_concernee (VARCHAR)
- details (JSONB) -- Donn√©es de l'action
- adresse_ip (VARCHAR)
- timestamp (TIMESTAMP)
```

## üîÑ PROCESSUS OP√âRATIONNELS

---

## 1. üë§ GESTION DES UTILISATEURS

### ‚ûï Cr√©ation d'un Utilisateur

**Pr√©requis :** √âquipes cr√©√©es

**√âtapes :**
1. **Acc√©der** ‚Üí Onglet "Utilisateurs" ‚Üí Bouton "Nouvel Utilisateur"
2. **Saisir les informations obligatoires :**
   - Nom *
   - Pr√©nom * 
   - Email * (validation format)
   - √âquipe (s√©lection dans liste d√©roulante)
3. **Informations optionnelles :**
   - T√©l√©phone (format international recommand√©)
   - Statut (Actif par d√©faut)
4. **Validation :** Bouton "Cr√©er l'utilisateur"

**R√©sultat :** 
- Utilisateur cr√©√© avec ID unique
- Ajout automatique dans l'√©quipe s√©lectionn√©e
- Log d'audit g√©n√©r√©
- Email de bienvenue (si configur√©)

**Erreurs possibles :**
- Email d√©j√† utilis√© ‚Üí Message d'erreur
- √âquipe inexistante ‚Üí S√©lection obligatoire
- Format email invalide ‚Üí Validation client

### ‚úèÔ∏è Modification d'un Utilisateur

**Pr√©requis :** Utilisateur existant

**√âtapes :**
1. **Localiser** ‚Üí Recherche par nom/email ou tri par colonnes
2. **√âditer** ‚Üí Clic sur l'ic√¥ne crayon ou double-clic sur la ligne
3. **Modifier** ‚Üí Changements autoris√©s :
   - Toutes les donn√©es personnelles
   - Changement d'√©quipe (impact sur les acc√®s)
   - Changement de statut (Actif ‚Üî Inactif)
4. **Sauvegarder** ‚Üí Bouton "Mettre √† jour"

**Impact automatique :**
- Changement d'√©quipe ‚Üí R√©vision des acc√®s logiciels
- Passage en Inactif ‚Üí Suspension des acc√®s (statut "Suspendu")
- Logs d√©taill√©s des modifications

### üóÇÔ∏è Archivage d'un Utilisateur

**Pr√©requis :** Utilisateur √† archiver (ex-employ√©)

**√âtapes :**
1. **S√©lectionner** ‚Üí Utilisateur dans la liste
2. **Archiver** ‚Üí Bouton "Archiver" (ic√¥ne dossier)
3. **Confirmer** ‚Üí Dialog de confirmation avec impact :
   - Suppression de tous les acc√®s logiciels
   - Conservation des donn√©es pour audit
   - Suppression des co√ªts futurs
4. **Validation** ‚Üí Archivage d√©finitif

**R√©sultat :**
- Utilisateur masqu√© des listes actives
- Acc√®s logiciels supprim√©s automatiquement  
- Donn√©es historiques conserv√©es
- √âconomies calcul√©es et report√©es

---

## 2. üè¢ GESTION DES √âQUIPES

### ‚ûï Cr√©ation d'une √âquipe

**√âtapes :**
1. **Acc√©der** ‚Üí Onglet "√âquipes" ‚Üí Bouton "Nouvelle √âquipe"
2. **Informations obligatoires :**
   - Nom de l'√©quipe *
3. **Informations optionnelles :**
   - Description (objectifs, domaine d'activit√©)
   - Budget mensuel (pour suivi des co√ªts)
   - Responsable (s√©lection parmi utilisateurs existants)
4. **Cr√©er** ‚Üí Validation

**R√©sultat :**
- √âquipe disponible pour affectation utilisateurs
- Dashboard √©quipe cr√©√© automatiquement
- Suivi budg√©taire initialis√©

### üìä Gestion Budg√©taire d'√âquipe

**Suivi automatique :**
- **Co√ªt actuel** = Somme des licences utilis√©es par l'√©quipe
- **Budget restant** = Budget mensuel - Co√ªt actuel  
- **Alertes** = Notifications si d√©passement > 90%

**Rapports disponibles :**
- Vue par √©quipe avec tous les logiciels utilis√©s
- Co√ªts mensuels et annuels par √©quipe
- Pr√©visions budg√©taires
- Export Excel d√©taill√©

---

## 3. üíª GESTION DES LOGICIELS

### ‚ûï Ajout d'un Nouveau Logiciel

**√âtapes :**
1. **Acc√©der** ‚Üí Onglet "Logiciels" ‚Üí Bouton "Nouveau Logiciel"
2. **Informations techniques :**
   - Nom du logiciel *
   - √âditeur (ex: Microsoft, Adobe, Slack)
   - Version (ex: 2024, Pro, Enterprise)
   - URL officiel (lien vers le site √©diteur)
   - Description (fonctionnalit√©s principales)

3. **Classification :**
   - ‚òëÔ∏è Logiciel de base (si essentiel √† l'activit√©)
   - ‚òëÔ∏è Application Shopify (si plugin e-commerce)
   - √âquipe propri√©taire (qui g√®re ce logiciel)

4. **Informations financi√®res :**
   - Qui paye ? (s√©lection utilisateur responsable)
   - Moyen de paiement : Carte/Pr√©l√®vement/Virement
   - P√©riodicit√© : Mensuel/Annuel/Trimestriel
   - Date de souscription (pour calculs d'√©ch√©ances)

5. **Statut :** Actif/Inactif/Test

**R√©sultat :**
- Logiciel disponible pour attribution d'acc√®s
- Calculs d'√©ch√©ances automatiques
- Suivi des co√ªts initialis√©

### üí∞ Configuration des Co√ªts

**Apr√®s cr√©ation du logiciel :**
1. **Acc√©der aux co√ªts** ‚Üí Bouton "‚Ç¨" dans le tableau
2. **D√©finir les tarifs par type d'acc√®s :**
   - Administrateur : XXX‚Ç¨/mois
   - Utilisateur : YYY‚Ç¨/mois  
   - Lecture seule : ZZZ‚Ç¨/mois
   - Acc√®s communs : Forfait √©quipe
3. **P√©riodes de validit√© :**
   - Date de d√©but
   - Date de fin (optionnelle)
   - Devise (EUR par d√©faut)

**Calculs automatiques :**
- **Co√ªt mensuel** = Somme par type d'acc√®s √ó Nombre d'utilisateurs
- **Co√ªt annuel** = Co√ªt mensuel √ó 12
- **Prochaine √©ch√©ance** = Bas√©e sur p√©riodicit√© et date souscription

---

## 4. üé´ GESTION DES ACC√àS

### ‚ûï Attribution d'un Acc√®s

**Pr√©requis :** Utilisateur et logiciel existants

**√âtapes :**
1. **M√©thode 1 - Via Utilisateurs :**
   - Onglet "Utilisateurs" ‚Üí Bouton "G√©rer acc√®s" (üë•)
   - S√©lection du logiciel
   - Choix du type d'acc√®s
   
2. **M√©thode 2 - Via Logiciels :**
   - Onglet "Logiciels" ‚Üí Bouton "G√©rer acc√®s" (üë•)
   - S√©lection de l'utilisateur
   - Choix du type d'acc√®s

3. **Configuration de l'acc√®s :**
   - **Type de droit :** Administrateur/Utilisateur/Lecture/Acc√®s communs
   - **Date d'expiration :** Optionnelle (pour acc√®s temporaires)
   - **Commentaires :** Notes sur l'attribution
   - **Statut :** Actif (par d√©faut)

**R√©sultat :**
- Acc√®s imm√©diatement disponible
- Co√ªt ajout√© aux calculs d'√©quipe
- Log d'attribution g√©n√©r√©
- Notification utilisateur (si configur√©e)

### üîÑ Modification d'un Acc√®s

**Changements possibles :**
- **Upgrade/Downgrade** ‚Üí Changement de type de droit
- **Extension temporelle** ‚Üí Modification date d'expiration  
- **Suspension** ‚Üí Statut "Suspendu" (conservation des donn√©es)
- **R√©activation** ‚Üí Retour en statut "Actif"

**Impact financier automatique :**
- Recalcul imm√©diat des co√ªts
- Mise √† jour des rapports d'√©quipe
- Historique des changements conserv√©

### ‚ùå Suppression d'un Acc√®s

**√âtapes :**
1. **Localiser** ‚Üí Acc√®s dans liste utilisateur ou logiciel
2. **Supprimer** ‚Üí Bouton poubelle rouge
3. **Confirmer** ‚Üí Impact affich√© :
   - Perte d'acc√®s imm√©diate
   - √âconomie g√©n√©r√©e (‚Ç¨/mois)
   - Conservation historique

**R√©sultat :**
- Acc√®s r√©voqu√© instantan√©ment  
- Co√ªt retir√© des calculs
- Log de suppression g√©n√©r√©

---

## 5. üìä RAPPORTS ET ANALYSES

### üìà Rapports Disponibles

#### **Vue par Logiciel**
- Liste de tous les logiciels avec :
  - Nombre d'utilisateurs par logiciel
  - Co√ªt mensuel et annuel
  - √âquipe propri√©taire
  - Prochaine √©ch√©ance de paiement
- **Export Excel** avec tous les d√©tails

#### **Vue par Utilisateur** 
- Liste de tous les utilisateurs avec :
  - Logiciels utilis√©s par personne
  - Co√ªt total par utilisateur (mensuel/annuel)
  - √âquipe d'appartenance
  - Statut des acc√®s
- **Export Excel** personnalis√©

#### **Vue par √âquipe**
- Liste de toutes les √©quipes avec :
  - Budget vs co√ªt r√©el
  - Logiciels utilis√©s par √©quipe
  - Membres et leurs acc√®s
  - Analyse d√©passement budg√©taire
- **Export Excel** avec calculs budg√©taires

### üíπ Tableaux de Bord

#### **Dashboard Principal**
- **Statistiques globales :**
  - Nombre total d'utilisateurs actifs
  - Nombre de logiciels g√©r√©s
  - Co√ªt mensuel total
  - **Co√ªt annuel total** (√ó12)
  - Nombre d'acc√®s actifs

#### **Graphiques Interactifs**
- **Co√ªts par √©quipe** (camembert)
- **√âvolution mensuelle** (histogramme)
- **R√©partition par type de logiciel** (barres)
- **Top 10 logiciels les plus co√ªteux**

### üìÖ √âch√©ancier des Paiements

**Vue calendaire :**
- Prochains paiements par mois
- Montants √† pr√©voir
- Logiciels concern√©s
- Alertes avant √©ch√©ance (7 jours)

---

## 6. üì§ IMPORT/EXPORT DE DONN√âES

### üì• Import Excel

**Formats support√©s :**
- **Utilisateurs** ‚Üí Nom, Pr√©nom, Email, √âquipe, T√©l√©phone
- **Logiciels** ‚Üí Nom, √âditeur, Version, √âquipe, Co√ªts
- **Acc√®s** ‚Üí Utilisateur, Logiciel, Type de droit

**Processus :**
1. T√©l√©charger le template Excel
2. Compl√©ter les donn√©es (validation automatique)
3. Uploader le fichier
4. Validation et preview
5. Import d√©finitif avec rapport d'erreurs

### üì§ Export Excel

**Exports disponibles :**
- **Export g√©n√©ral** ‚Üí Toutes les donn√©es (5 feuilles)
- **Export par logiciel** ‚Üí Utilisateurs et co√ªts par logiciel
- **Export par √©quipe** ‚Üí Budget et logiciels par √©quipe  
- **Export financier** ‚Üí Co√ªts mensuels et annuels d√©taill√©s

**Format :**
- Fichiers Excel (.xlsx) avec mise en forme
- Colonnes calcul√©es (totaux, moyennes)
- Graphiques int√©gr√©s
- Pr√™t pour pr√©sentation direction

---

## 7. üîç AUDIT ET LOGS

### üìã Tra√ßabilit√© Compl√®te

**Actions logg√©es automatiquement :**
- Cr√©ation/modification/suppression d'utilisateurs
- Attribution/r√©vocation d'acc√®s logiciels
- Changements de statuts et d'√©quipes
- Connexions et authentifications
- Exports de donn√©es

**Informations enregistr√©es :**
- Qui ? (utilisateur ayant effectu√© l'action)  
- Quoi ? (type d'action et donn√©es modifi√©es)
- Quand ? (timestamp pr√©cis)
- O√π ? (adresse IP de connexion)
- D√©tails complets en JSON

### üîç Consultation des Logs

**Filtres disponibles :**
- Par utilisateur (qui a fait l'action)
- Par date/p√©riode
- Par type d'action  
- Par table concern√©e
- Recherche dans les d√©tails

**Exports d'audit :**
- Rapport d'activit√© par p√©riode
- Actions d'un utilisateur sp√©cifique  
- Historique d'un logiciel/acc√®s
- Conformit√© r√©glementaire (RGPD)

---

## 8. ‚öôÔ∏è ADMINISTRATION

### üîë Types de Droits d'Acc√®s

**Configuration des niveaux :**
- **Administrateur** (Niveau 5) ‚Üí Gestion compl√®te
- **Utilisateur** (Niveau 3) ‚Üí Utilisation standard  
- **Lecture** (Niveau 1) ‚Üí Consultation seulement
- **Acc√®s communs** (Niveau 2) ‚Üí Partag√© √©quipe

**Gestion :**
- Cr√©ation de nouveaux types si besoin
- Modification des niveaux d'acc√®s
- D√©finition des co√ªts par type
- Attribution par d√©faut par √©quipe

### üíª Console et Debug

**Commandes administrateur :**
```javascript
// Mode production silencieux
consoleMgr.silence()

// Debug sp√©cifique
consoleMgr.debug('supabase')  // Pour probl√®mes API
consoleMgr.debug('reports')   // Pour probl√®mes rapports

// Statistiques syst√®me  
consoleMgr.stats()
```

**Monitoring :**
- Nombre de requ√™tes API
- Temps de r√©ponse moyens
- Erreurs et alertes
- Performance g√©n√©rale

---

## üìã WORKFLOWS TYPES

### üÜï Onboarding Nouvel Employ√©

1. **Cr√©er l'utilisateur** ‚Üí Onglet Utilisateurs
2. **Affecter √† l'√©quipe** ‚Üí S√©lection √©quipe appropri√©e  
3. **Attribuer logiciels de base** ‚Üí Acc√®s essentiels (email, bureautique)
4. **Attribuer logiciels sp√©cifiques** ‚Üí Selon le poste
5. **V√©rifier budget √©quipe** ‚Üí Impact sur co√ªts mensuels

### üíº Changement d'√âquipe

1. **Modifier l'utilisateur** ‚Üí Nouvelle √©quipe
2. **R√©viser les acc√®s** ‚Üí Suppression acc√®s ancienne √©quipe  
3. **Ajouter nouveaux acc√®s** ‚Üí Logiciels nouvelle √©quipe
4. **Valider budgets** ‚Üí Impact sur les deux √©quipes

### üìà Audit Financier Mensuel

1. **Rapport par √©quipe** ‚Üí Vue budg√©taire
2. **Analyse d√©passements** ‚Üí √âquipes > budget
3. **Top logiciels co√ªteux** ‚Üí Optimisation possible
4. **Export Excel direction** ‚Üí Pr√©sentation mensuelle
5. **Planification renouvellements** ‚Üí √âch√©ances √† venir

### üîÑ Renouvellement de Logiciel

1. **Consulter √©ch√©ancier** ‚Üí Prochaines √©ch√©ances
2. **Analyser utilisation** ‚Üí Nombre d'utilisateurs r√©els
3. **N√©gocier tarifs** ‚Üí Avec √©diteur si volume
4. **Mettre √† jour co√ªts** ‚Üí Nouveaux tarifs dans syst√®me
5. **Communiquer √©quipes** ‚Üí Changements et impact

---

## üéØ BONNES PRATIQUES

### ‚úÖ Gestion Quotidienne

- **V√©rifier nouveaux acc√®s** ‚Üí Validation des demandes  
- **Contr√¥ler budgets √©quipes** ‚Üí Alertes d√©passement
- **Suivre √©ch√©ances** ‚Üí Pr√©paration renouvellements
- **Consulter logs** ‚Üí Activit√© suspecte

### üìä Optimisation Financi√®re

- **Audit trimestriel** ‚Üí Utilisateurs inactifs
- **N√©gociation annuelle** ‚Üí Volumes et remises
- **Consolidation logiciels** ‚Üí √âviter doublons fonctionnels
- **Formation √©quipes** ‚Üí Utilisation optimale

### üîí S√©curit√© et Conformit√©

- **R√©vision acc√®s mensuelle** ‚Üí Principe du moindre privil√®ge
- **Audit logs r√©gulier** ‚Üí D√©tection anomalies  
- **Sauvegarde donn√©es** ‚Üí Export mensuel s√©curis√©
- **Documentation processus** ‚Üí Maintien de la continuit√©

---

## üö® GESTION DES INCIDENTS

### ‚ùå Probl√®mes Courants

**Utilisateur ne peut pas acc√©der √† un logiciel :**
1. V√©rifier statut utilisateur (Actif ?)
2. Contr√¥ler acc√®s logiciel (Attribu√© ? Expir√© ?)
3. V√©rifier statut logiciel (Actif ?)
4. Consulter logs pour derni√®res modifications

**Co√ªts incorrects dans rapports :**
1. V√©rifier configuration co√ªts logiciel
2. Contr√¥ler dates de validit√© des tarifs  
3. Recalculer si modification r√©cente
4. Exporter pour validation externe

**Performance d√©grad√©e :**
1. Console ‚Üí `consoleMgr.stats()` pour diagnostic
2. Activer logs sp√©cifiques si n√©cessaire
3. V√©rifier charge API Supabase
4. Mode silence si trop de logs

### üìû Support et Escalade

**Niveaux de support :**
1. **Utilisateur final** ‚Üí Guide utilisateur + FAQ
2. **Administrateur IT** ‚Üí Ce document + console debug  
3. **Support technique** ‚Üí Logs d√©taill√©s + API directe
4. **√âditeur Supabase** ‚Üí Probl√®mes infrastructure

---

*üöÄ Cette documentation couvre l'ensemble des processus. Pour mise en production, utiliser `consoleMgr.silence()` pour des logs minimaux.*